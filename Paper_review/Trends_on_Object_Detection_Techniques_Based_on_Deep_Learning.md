# 딥러닝 기반 객체 인식 기술 동향

## Trends on Object Detection Techniques Based on Deep Learning



이진수(지식이러닝연구그룹/UST 석사과정), 이상광(지식이러닝연구그룹 책임연구원), 

김대욱(지식이러닝연구그룹 연구원), 홍승진(홍익대학교 게임학부 석사과정)

양성일(지식이러닝연구그룹 책임연구원/PL)



DOI: 10.22648/ETRI. 2018. J. 330403







## 0. 요약

객체 탐지 분야는 시각적 탐구, 어떤 장면에서의 물체 감지, 물체의 위치 파악이 필요한 곳에서 (사람들이) 도전하고 있는 분야이다. 이 기술은 자율 주행, 영상 감시, 안면 인식 같은 분야에 적용되고 있다. 전통적으로는 수동으로 문제를 해결하려고 했는데 이때 정확성과 컴퓨팅 효율성 사이에  균형 문제가 있었다. 딥러닝은 머신러닝 분야에서 혁명적인 패러다임이었고 특히 CNN은 객체 탐지에서 기존의 방법들을 능가하는 성능을 보였다. 이 논문에서는 최근에 객체 탐지에서 쓰였던 딥러닝 기법, 아키텍처에 대한 요약을 하고자 한다. 또한 이 기법과 아키텍처들의 성능을 비교하고 객체 탐지 분야의 연구 가이드를 제시하고자 한다.







## 1. 서론

최근 객체 인식 분야는 여러 산업 전반에서 핵심기술로 사용되고 있다. 이에 부응하여 PASCAL, ImageNet, MS COCO 등 객체 인식 관련 대회를 개최하고 있다.

과거의 객체 인식 연구(SIFT-Scale Invariant Feature Transform, SURF-Speede-Up Robust Features, Haar, HOG-Histogram of Oriented Gradients)에서는 객체가 가지는 특징을 설계하고 검출해서 객체를 찾아내는 방식으로 진행되었다.

DPM(Deformable Part-based Model)에서는 물체를 여러 부분으로 나누어 특징 정보를 구성하고, 각 부분의 유동적인 구조를 SVM(Support Vector Machine) 등의 방법으로 연결하여 객체 인식 성능을 높였다.

합성곱 신경망(CNN-Convolutional Neural Network)이 ImageNet 2012 대회에서 압도적인 성능을 보여줬고 CNN의 인식률을 향상시키기 위한 연구에서 ZFNet, VGG, ResNet, GoogLeNet, DenseNet 등이 등장하였다.

CNN을 통해 객체 분류 문제는 어느정도 성공을 거뒀으나, 영상에서 객체의 위치를 검출하는 방법에 대한 연구가 후속적으로 등장했다.

R-CNN(Region-based Convolutional Neural Networks)는 딥러닝 회귀(Regression)방법으로 이 문제를 해결했다.

Fast R-CNN은 R-CNN의 느린 검출 속도를 보완했으나 R-CNN과 마찬가지로 딥러닝 망에서 객체의 후보 영역을 찾을 수 없어서 속도가 객체 후보 영역을 찾는 부분에 의존한다는 단점이 있었다.

Faster R-CNN에서는 객체 후보 영역을 딥러닝 네트워크 속에 편입시켜 이 문제를 해결함으로서 검출 속도를 향상시켰다. 

R-FCN(Region-based Fully Convolutional Networks)은 Faster R-CNN이 영상의 지역적 정보에 의존한다는 단점을 보완하기 위해 등장했다.

이러한 발전으로 객체 인식 속도가 개선되었으나 실시간 처리 작업, 자율 주행등의 요구사항에 적용하는데는 충분하지 못했다.

YOLO(You Only Look Once)는 이러한 속도 문제를 해결하기 위해 객체 인식의 모든 과정을 하나의 딥러닝 네트워크로 구성하는 방법을 제안했다.

SSD(Single Shot MultiBox Detector)은 모바일에서도 동작이 가능한 정도의 빠른 검출 속도를 보인다.

Image Segmentation 분야에서는 단순히 객체의 영역 박스를 찾는 수준이 아니라 객체의 픽셀 영역을 찾는 연구를 진행하고 있다.







## 2.객체 인식 기술 동향

### 1. 객체 인식 방법

#### 가. R-CNN

1.  입력된 영상에서 **선택적 탐색(Selective Search)** 알고리즘으로 후보 영역 생성.
2. 생성된 각 후보 영역을 동일 크기로 변환, CNN으로 특징 추출.
3. 추출된 특징으로 후보 영역 내의 객체를 SVM으로 분류.
4. 1번 단계에서 생성된 후보 영역의 위치가 정확하지 않기 때문에 회귀 학습을 통해 객체 영역 박스 위치 보정.

#### 나. Fast R-CNN

- R-CNN은 CNN, SVM, 회귀의 학습 단계가 분리되어 있고 각 후보 영역에서 각가의 CNN을 학습해야 하므로 훈련 하는 데에 많은 시간 소요.
- Fast R-CNN은 하나의 입력 영상에 대해 하나의 CNN 학습.
- 학습된 CNN을 통해 생성된 Feature map을 통합(Pooling)하여 특징 추출.
- 분류기의 손실과 영역 박스 회귀의 손실을 동시에 훈련.
- 분류기에는 SVM 대신 Softmax 적용.

#### 다. Faster R-CNN

- Fast R-CNN은 후보 영역 생성이 CNN 외부에서 수행, 속도 저하, 알고리즘 학습 불가.

- 후보 영역 생성에 선택적 탐색 알고리즘을 사용하지 않고 CNN 마지막 층에 후보 영역을 생성하는 별도의 CNN인 **영역 제안 네트워크(RPN: Region Proposal Network)** 를 적용.

- CNN에서 추출된 Feature map을 RPN에서 추정된 후보 영역으로 잘라내어 객체 인식

  (**ROI Pooling(Region of Interest Pooling)** ).

#### 라. R-FCN

- R-FCN은 위치 정보를 포함하고 있는 Score Map을 이용하여 물체의 위치 파악.
- Score Map은 Feature map으로 부터 얻어지며 영상 내 특정 위치의 정보 포함.
- 특정 위치마다 분류 결과를 얻어 이를 종합, 최종적으로 특정 위치 내의 객체 분류.
- 특정 위치가 타겟을 포함할 경우 Score Map의 반응 증가, 반대의 경우 반응 감소.
- Score Map은 위치 정보를 포함하고 있으면서 훈련을 요구하지 않는 장점이 있음.

#### 마. YOLO

- 객체 인식 문제를 하나의 회귀 문제로 접근, 전체 구조를 간소화하여 훈련 및 검출 속도 향상
- 입력된 영상은 CNN을 거쳐 텐서(Tensor) 형태로 출력.
- 이 텐서는 영상을 격자 형태로 나누어 각 구역을 표현하고 해당 구역의 객체 인식.
- 관심 영역을 추출하기 위한 별도의 네트워크 불필요.
- Faster R-CNN보다 월등히 빠른 훈련속도. 그러나 인식 정확도가 다소 떨어지고 특히 작은 물체를 인식하는데 어려움 존재.

#### 바. SSD

- YOLO와 같이 후보 영역을 생성하기 위한 RPN 불필요, 다양한 크기의 Feature map을 이용하여 객체 인식.
- 합성곱 층(Convolution Layer)이 깊어짐에 따라 Feature map의 크기가 감소. 이 과정에서 추출된 모든 Feature map을 추론과정에 사용하여 객체 인식.
- 얕은 깊이의 크기가 큰 Feature map은 작은 물체 검출, 깊은 깊이의 크기가 작은 Feature map은 큰 물체 검출.
- RPN을 제거하여 속도 향상, 다양한 크기의 Feature map을 이용하여 정확도 향상.



### 2. 객체 인식 모델

#### 가. AlexNet

- 8개의 층으로 이루어진 CNN 구조. 빠른 연산을 위해 2개의 GPU 사용.
- 5개의 합성곱 층과 3개의 완전 연결 층(Fully-Connected Layer)로 이루어짐.
- 활성 함수(Activation Function)로는  ReLU(Rectified Linear Unit) 사용.
- 과적합 방지를 위해 입력 영상을 임의로 잘라내거나 픽셀의 밝기를 조정하는 데이터 가공 방법 사용.
- Fully-Connected Layer에 Dropout 적용.

#### 나. ZFNet

- CNN 모델 내부의 층을 시각화 하는 방법 제시.
- CNN 내부의 한 층을 시각화 하기 위해서는 층의 반응을 입력 영상의 크기로 매핑(Mapping)할 필요가 있음.
- 하나의 층은 합성곱, 활성화, 통합(Pooling)의 세 가지 과정으로 이루어져 각 층마다 역으로 입력 영상의 크기로 매핑.
- 얕은 층에서는 선이나 모양 등의 단순한 특징들 추출, 깊은 층에서는 객체의 형태와 가까운 특징들 추출.
- 합성곱 층 시각화를 통해 얻은 정보로 AlexNet의 초기 층을 수정하여 ZFNet 구성.

#### 다. VGG

- CNN의 층 깊이에 따른 성능 변화 연구를 통해 제안됨.

- 층의 깊이외 5번의 통합(Pooling) 사용, 모든 필터의 크기 3으로 설정 등 각 모델의 설정 동일.

- 모델의 깊이는 11개부터 19개 사이의 5개의 모델 사용.

-  필터의 크기를 3으로 설정하고 반복 사용시 더 큰 크기의 필터의 역할을 할 수 있음을 강조.

  (3x3 convolution을 두 번 쌓는 것은 5x5 convolution과 동일한 receptive field의 정보를 처리하고, 세 번 쌓는 것은 7x7의 receptive field의 정보를 처리한다. 하지만, 3x3을 여러번 쌓는 것이 더 좋은 성능을 낸다. 그 이유는 두 가지이다. 첫째로 3x3 convolution 연산을 여러번 하는 것은 여러번의 비선형 처리를 해주는 것이므로, 큰 필터로 한번 연산 했을 때보다 더 많은 비선형성을 가질 수 있다. 두번째로는 그럼에도 불구하고, 파라미터 수는 3x3 convolution을 여러번 했을 때 더 적다. 예를 들어, 채널의 갯수가 CC라고 할 때, 7x7의 경우는 72×C272×C2의 파라미터를 가지지만, 3x3을 세 번 쌓은 경우에는, 3×(32×C2)3×(32×C2)의 파라미터를 가진다.)

#### 라.GoogLeNet

- 깊은 CNN 구조에서는 과적합, **기울기 소실(Vanishing Gradient)** , 연산량의 급격한 증가 등의 문제 발생.
- 깊이가 깊으면서 연산량 측면에서 밀도가 높은(Dense) 구조인 Inception 모듈 개발.
- 여러 크기의 합성곱 층과 통합 층(Pooling Layer)이 병렬적으로 수행되고 결과를 합침.
- 여러 크기의 합성곱 층의 연산이 요구하는 연산량을 줄이기 위해서 크기가 1인 합성곱 연산을 이용하여 차원을 감소시키는 병목(Bottleneck) 구조 구성.
- Inception 모듈 9개로 이루어짐.

#### 마. ResNet

- 깊이가 수백, 수천 개로 증가하게 되면 오히려 정확도가 떨어지는 문제 발생.
- 이를 해결하기 위해 **잔차 학습(Residual Learning)** 이라는 방법 적용.
- 잔차 학습은 특정 층이 단순히 출력을 학습하는 것이 아니라 입력과 출력의 차이를 학습하여 작은 변화에 대해 민감하게 반응할 수 있도록 훈련하는 방법.
- 입력과 출력의 차이를 학습하게 하는 것은 덧셈 연산으로만 구현되어 추가적인 매개변수를 요구하지 않음.
- ResNet은 잔차 학습의 개념을 34개의 층으로 구성된 VGG에 적용시킨 모델.

#### 바. DenseNet

- ResNet과 이를 응용한 많은 모델에서 특정 층들이 최종 출력에 기여하는 정도가 적거나 없어지는 문제가 발생.
- 이를 해결하기 위해 모든 층이 ResNet의 잔차 학습 방법으로 연결되어 있는 구조 제시.
- 모든 층의 출력은 각각의 후속 층의 입력으로 들어감. 이따 합 연산이 아닌 입력이 중첩되는 구조.
- L번째 층은 L(L+1)/2 개의 입력을 갖음.
- ResNet보다 더 적은 매개변수를 가지기 때문에 더 빠른 학습 가능. 향상된 성능.







## 3. 객체 인식 기술 성능 비교

 R-FCN과 SSD는 훈련에 소요되는 시간이 비교적 적지만 낮은 정확도를 보이고 Faster R-CNN은 훈련에 시간이 많이 소요되지만 비교적 높은 정확도를 보임. ResNet-101과 Inception ResNet V2의 정확도가 가장 높고 SSD의 경우 CNN 모델에 따른 정확도의 변동이 적은 편임.







## 4. 결론

현재의 객체 인식 기술은 특정 도메인에서의 객체 인식 정확도는 높으나 일반적인 객체를 인식하는 데에는 좋은 결과를 보이지 못하는데 이는 정확도를 높이기 위해 모델의 용량을 키우면 과적합이나 기울기 소실 등의 문제가 발생하기 때문. 이를 해결하기 위한 연구와 객체를 상자 형태로 검출하는 것 말고 필셀 단위로 분할하는 연구도 이뤄지고 있음. 요구되는 하드웨어 자원을 감소시키기 위해 보다 단순한 구조의 객체 인식 방법과 가벼운 CNN 모델에 대한 연구 필요.
